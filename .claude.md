# Claude Code - Gavin's Grades Project Guide

## ğŸš€ Speed Optimization Rules

### For This Local/Private Repo

**SKIP these tools:**
- âŒ `octocode` (repo is private, not on GitHub public API)
- âŒ `deepwiki` for general concepts (use only if truly needed)
- âš ï¸ `sequential-thinking` - Keep to 3-4 thoughts max, not 8+

**USE these efficiently:**
- âœ… `Glob` + `Read` for repo exploration (fast, local)
- âœ… `Grep` for finding patterns
- âœ… `astrodocs` only when Astro-specific patterns needed
- âœ… Direct implementation after basic understanding

### Research vs. Implementation Balance

**For small features (<500 lines):**
```
Research: 10-15 min max
Implementation: 20-30 min
Testing: 10-15 min
Documentation: 5-10 min (concise)
```

**When you have enough context to START:**
- âœ… You understand the data model
- âœ… You know where the code goes
- âœ… You've seen 1-2 similar components
- âŒ Don't need to understand every edge case upfront

**Start coding when you're 70% confident, not 95%**

## ğŸ“ Project Structure (Quick Reference)

```
src/
â”œâ”€â”€ components/          # Astro components (UI)
â”‚   â”œâ”€â”€ *.astro         # Server-rendered, can have <script> for client-side
â”‚   â””â”€â”€ Use retro gaming theme: #00ff00, #000, borders
â”œâ”€â”€ pages/              # Routes (file-based routing)
â”‚   â”œâ”€â”€ index.astro     # Home page (/)
â”‚   â”œâ”€â”€ classes/
â”‚   â”‚   â””â”€â”€ [classId].astro  # Dynamic routes
â”œâ”€â”€ types/              # TypeScript interfaces
â”‚   â””â”€â”€ grades.ts       # Main data models
â”œâ”€â”€ utils/              # Helper functions (pure, testable)
â”œâ”€â”€ data/               # JSON data files
â”‚   â”œâ”€â”€ grades.json     # Main grades data (auto-updated)
â”‚   â””â”€â”€ missing_assignments.json
â””â”€â”€ styles/             # Global CSS

tests/
â””â”€â”€ e2e/               # Playwright tests
```

## ğŸ¨ Design System (Quick Reference)

**Colors:**
- Primary: `#00ff00` (neon green)
- Background: `#000` (black)
- Borders: `#fff` (white), 3-4px solid
- Text: White on black
- Gray: `#555`, `#aaa`

**Grade Colors (reuse `getGradeColor()` function):**
- A (90+): `grade-a` class
- B (80-89): `grade-b` class
- C (70-79): `grade-c` class
- D (60-69): `grade-d` class
- F (<60): `grade-f` class

**Component Pattern:**
```astro
<div class="shadow-[0_0_0_4px_#000,0_0_0_8px_#fff,8px_8px_0_8px_rgba(255,255,255,0.3)] relative p-5 border-4 border-solid border-white card">
  <div class="flex items-center gap-[15px] mb-5 pb-[15px] border-b-[3px] border-b-[#555] border-dashed">
    <div class="w-12 h-12 flex items-center justify-center text-[1.2em] border-[3px] border-solid border-[#00ff00] bg-[#000]">
      ğŸ¯
    </div>
    <div class="text-[0.7em] text-[#00ff00]">COMPONENT.NAME</div>
  </div>
  <!-- Content here -->
</div>
```

**Typography:**
- Use UPPERCASE for labels
- Gaming terminology preferred (QUESTS, XP, LEVELS, etc.)
- Font sizes: `text-[0.4em]`, `text-[0.5em]`, `text-[0.6em]`, etc.

## ğŸ“Š Data Model (Quick Reference)

```typescript
// From src/types/grades.ts
interface Class {
  class_id?: string;      // May be undefined, use period as fallback
  class_name: string;
  teacher: string;
  period: string;         // Used for routing: /classes/[period]
  current_grade: number;  // Percentage (0-100)
  letter_grade: string;   // A, B, C, D, F
  q1_grade: number | null;
  q2_grade: number | null;
  assignments?: Assignment[];  // OPTIONAL - may not exist
}

interface Assignment {
  id: string;
  name: string;
  category: string;
  dueDate: string;
  score: number | null;    // null = missing
  maxPoints: number;
  percentage: number | null;
  status?: "graded" | "missing" | "pending";
}
```

**Important:**
- âš ï¸ Most classes DON'T have `assignments` array
- âš ï¸ Grades come pre-calculated from scraper (no calculation logic in app)
- âš ï¸ `class_id` may be undefined, use `period` instead

## ğŸ§ª Testing Quick Start

```bash
# Playwright E2E
npx playwright test                    # Run all tests
npx playwright test --ui              # Interactive mode (RECOMMENDED)
npx playwright test --headed          # See browser
npx playwright test file.spec.ts     # Specific test

# First time only
npx playwright install
```

**Test Pattern:**
```typescript
test.describe("Feature Name", () => {
  test.beforeEach(async ({ page }) => {
    await page.goto("/classes/1");
    await page.waitForLoadState("networkidle");
  });

  test("should do something", async ({ page }) => {
    await expect(page.locator("#element-id")).toBeVisible();
  });
});
```

## ğŸ¯ Common Tasks - Fast Templates

### Adding a New Component

1. **Create file:** `src/components/MyComponent.astro`
2. **Use template:**
```astro
---
// Props interface
interface Props {
  data: string;
}
const { data } = Astro.props;
---

<div class="shadow-[0_0_0_4px_#000,0_0_0_8px_#fff,8px_8px_0_8px_rgba(255,255,255,0.3)] relative p-5 border-4 border-solid border-white card">
  <!-- Header -->
  <div class="flex items-center gap-[15px] mb-5 pb-[15px] border-b-[3px] border-b-[#555] border-dashed">
    <div class="w-12 h-12 flex items-center justify-center text-[1.2em] border-[3px] border-solid border-[#00ff00] bg-[#000]">
      ğŸ¯
    </div>
    <div class="text-[0.7em] text-[#00ff00]">COMPONENT.NAME</div>
  </div>

  <!-- Content -->
  <div>
    {data}
  </div>
</div>

<script>
  // Client-side JavaScript (optional)
  console.log("Component mounted");
</script>
```

3. **Import in page:** `import MyComponent from "../components/MyComponent.astro"`

### Adding Client-Side Interactivity

**For simple interactivity (form, button clicks):**
```astro
<script>
  // Runs on client after hydration
  const button = document.getElementById("my-btn");
  button?.addEventListener("click", () => {
    console.log("Clicked!");
  });
</script>
```

**Don't need:** React/Preact/Vue for simple stuff. Use `<script>` tags.

### Adding a Utility Function

1. **Create:** `src/utils/myUtil.ts`
2. **Make it pure:**
```typescript
export interface MyInput {
  value: number;
}

export interface MyResult {
  calculated: number;
}

export function calculateSomething(input: MyInput): MyResult {
  // Pure function - no side effects
  return {
    calculated: input.value * 2
  };
}
```

3. **Use in Astro component:**
```astro
---
import { calculateSomething } from "../utils/myUtil";
const result = calculateSomething({ value: 42 });
---
```

4. **Use in client script:**
```astro
<script>
  import { calculateSomething } from "../utils/myUtil";
  const result = calculateSomething({ value: 42 });
</script>
```

## âš¡ Speed Optimization Checklist

When starting a new feature:

- [ ] **Understand basics** (10 min max):
  - [ ] Read 1-2 similar components
  - [ ] Check data model in `src/types/grades.ts`
  - [ ] Look at existing routes/pages

- [ ] **Start coding** (don't over-research):
  - [ ] Create component file
  - [ ] Use design template above
  - [ ] Implement core logic
  - [ ] Add client script if needed

- [ ] **Test quickly:**
  - [ ] `npm run build` (verify no errors)
  - [ ] Test in browser
  - [ ] Add 1-2 key E2E tests

- [ ] **Document concisely:**
  - [ ] JSDoc on exported functions
  - [ ] Brief comment on complex logic
  - [ ] âŒ Skip lengthy feature docs unless requested

## ğŸ” Debugging Tips

```bash
# Build errors
npm run build          # Check TypeScript errors

# Dev server
npm run dev           # Auto-reloads on changes

# Check specific component
# Visit page in browser, open DevTools Console
```

## ğŸ“ Documentation Guidelines

**For this project:**
- âœ… JSDoc on all exported functions
- âœ… Inline comments for complex logic
- âœ… README.md updates for major features
- âŒ Skip verbose feature specs unless user requests
- âŒ Skip architecture docs for small changes

**Concise > Comprehensive** (unless user asks for detailed docs)

## ğŸ“ Learning Resources

**Astro Docs** (use sparingly):
- Islands: https://docs.astro.build/en/concepts/islands/
- Components: https://docs.astro.build/en/basics/astro-components/
- Scripts: https://docs.astro.build/en/guides/client-side-scripts/

**This codebase:**
- Study existing components in `src/components/`
- Check `src/pages/classes/[classId].astro` for patterns

## ğŸš« What NOT to Do

- âŒ Don't use octocode (repo is private)
- âŒ Don't over-research before coding
- âŒ Don't add new runtime dependencies without asking
- âŒ Don't create elaborate docs for simple features
- âŒ Don't duplicate existing code (reuse `getGradeColor`, etc.)
- âŒ Don't break the retro gaming aesthetic
- âŒ Don't assume all classes have `assignments` data

## âœ… What TO Do

- âœ… Start coding after basic understanding (70% confidence)
- âœ… Reuse existing design patterns and colors
- âœ… Keep TypeScript strict (no `any`)
- âœ… Make utility functions pure (testable)
- âœ… Add E2E tests for critical paths
- âœ… Use `<script>` tags for simple client-side logic
- âœ… Match the retro gaming theme exactly

## ğŸ“ Definition of Done (Quick Checklist)

For any feature:
- [ ] Code written and integrated
- [ ] `npm run build` succeeds
- [ ] Tested in browser (works on desktop + mobile)
- [ ] At least 1 E2E test for happy path
- [ ] Matches design system
- [ ] TypeScript strict (no `any`)
- [ ] Brief inline comments on complex parts

---

**Last Updated:** December 2025
**For questions:** Check this file first, then ask!
